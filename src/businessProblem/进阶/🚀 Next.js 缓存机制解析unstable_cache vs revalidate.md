---
title: Next.js ç¼“å­˜æœºåˆ¶è§£æï¼šunstable_cache vs revalidate
icon: circle-info
---

## **1ï¸âƒ£**** æœ¬è´¨é€è§†é•œï¼šæ˜¯ä»€ä¹ˆï¼Ÿ**
  


**æœ¬è´¨æ˜¯**ï¼šNext.js ä¸­ä¸¤ç§ä¸åŒå±‚çº§çš„ç¼“å­˜æ§åˆ¶æœºåˆ¶ï¼Œåˆ†åˆ«ç”¨äº

â†’ unstable_cache: **å‡½æ•°çº§ç¼“å­˜**

â†’ revalidate: **è·¯ç”±çº§ ISR ç¼“å­˜æ§åˆ¶**
  


è¿™å…¶å®å°±æ˜¯ï¼š**æ‰§è¡Œå±‚ vs æ„å»ºå±‚çš„ç¼“å­˜ç²’åº¦æ§åˆ¶å·¥å…·**ã€‚

---

## **2ï¸âƒ£**** å…³ç³»æ‹“æ‰‘å›¾ï¼šä¸ºä»€ä¹ˆå­˜åœ¨ï¼Ÿ**
```plain
getStaticProps â†’ HTML + JSON ç”Ÿæˆ â†’ ç¼“å­˜ï¼ˆåŸºäº revalidateï¼‰  
                               â†‘  
                      è¯·æ±‚è§¦å‘ ISR åˆ¤æ–­

fetch/DB è°ƒç”¨ â†’ ä½¿ç”¨ unstable_cache â†’ ç»“æœç¼“å­˜ â†’ å‡å°‘ I/O å¼€é”€
```

+ revalidate: æ§åˆ¶ **é¡µé¢çº§ç”Ÿæˆçš„ HTML/JSON ç¼“å­˜åˆ·æ–°æ—¶é—´**
+ unstable_cache: æ§åˆ¶ **æŸä¸ªå‡½æ•°ï¼ˆå¦‚ API/fetchï¼‰åœ¨æ„å»º/è¯·æ±‚æ—¶ç¼“å­˜è°ƒç”¨ç»“æœ**



### **âš ï¸**** å…³é”®åŒºåˆ«ï¼š**
| **ç‰¹æ€§** | revalidate | unstable_cache |
| --- | --- | --- |
| ç¼“å­˜ç²’åº¦ | é¡µé¢ï¼ˆrouteï¼‰ | å‡½æ•°ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰ |
| è§¦å‘æ—¶æœº | è¯·æ±‚åˆ°è¾¾æ—¶ | å‡½æ•°æ‰§è¡Œæ—¶ |
| é…ç½®ä½ç½® | é¡µé¢æ–‡ä»¶ï¼ˆgenerateStaticParamsã€revalidateï¼‰ | å‡½æ•°åŒ…è£…å™¨ |
| æ•°æ®ç±»å‹ | é™æ€å†…å®¹ï¼ˆHTML/JSONï¼‰ | ä»»æ„æ•°æ®ï¼ˆfetch, db, etcï¼‰ |
| ç¼“å­˜ä½ç½® | Edge / CDN å±‚ | Edge + Memory å±‚ |


---

## **3ï¸âƒ£**** è¡ŒåŠ¨æ„ä¹‰é”šç‚¹ï¼šä¸ºä»€ä¹ˆè¦ç”¨ï¼Ÿ**


**æ ¸å¿ƒä»·å€¼æ˜¯ï¼š**

ç²¾å‡†ç¼“å­˜æ§åˆ¶ï¼Œ**æå‡æ€§èƒ½ & å‡å°‘å†·å¯åŠ¨å¼€é”€**

| **å¦‚æœä¸åšç¼“å­˜** | **å¦‚æœæ­£ç¡®ä½¿ç”¨ç¼“å­˜** |
| --- | --- |
| SSR/åŠ¨æ€è¯·æ±‚å‹åŠ›å¤§ | å‡å°‘é‡å¤æ•°æ®åº“è°ƒç”¨ |
| ç”¨æˆ·æ¯æ¬¡è®¿é—®éƒ½è§¦å‘ API è°ƒç”¨ | é‡ç”¨ç¼“å­˜å†…å®¹ï¼ŒTTFB é™ä½ |
| æ— æ³•é¢„ä¼°ç¼“å­˜æ—¶æ•ˆæ€§ | ç²¾å‡†æ§åˆ¶æŸæ®µé€»è¾‘ç¼“å­˜æ—¶é—´ |


âœ… **ä¸šåŠ¡ç»‘å®šç¤ºä¾‹ï¼š**

  


<font style="color:#0e0e0e;">åœ¨ç”µå•†é¦–é¡µä¸­ï¼ŒæŸä¸ªæ•°æ®ï¼ˆå¦‚ banner æˆ–åº“å­˜ï¼‰æ¯ 10 ç§’æ›´æ–°ä¸€æ¬¡ï¼Œç”¨ </font><font style="color:#0e0e0e;">unstable_cache(fn, [key], { revalidate: 10 })</font><font style="color:#0e0e0e;"> åŒ…è£¹ fetchï¼Œé¿å…é‡å¤ DB è¯»å–</font>

---

## **4ï¸âƒ£**** æ­¥éª¤æ‹†è§£å™¨ï¼šæ€ä¹ˆåšï¼Ÿ**
### **âœ…**** revalidateå®æˆ˜ï¼ˆè·¯ç”±çº§ç¼“å­˜ï¼‰**
æ“ä½œè·¯å¾„ï¼š

â‘  åœ¨é¡µé¢ä¸­æ·»åŠ  export const revalidate = 60

â†’ é¡µé¢é™æ€æ„å»ºåï¼Œæ¯ 60s è§¦å‘ä¸€æ¬¡å†ç”Ÿæˆ

```plain
// app/products/page.tsx
export const revalidate = 60;

export default async function ProductsPage() {
  const res = await fetch('https://api.example.com/products');
  const data = await res.json();
  return <ProductList data={data} />;
}
```

â—æ³¨æ„ï¼š

+ é¡µé¢å°†ç”Ÿæˆé™æ€ HTML å’Œ JSONï¼Œ60 ç§’ä¹‹åé‡æ–°æ„å»º
+ æµè§ˆå™¨å’Œ CDN å±‚ä¾æ—§å‘½ä¸­ç¼“å­˜

---

### **âœ…**** unstable_cache å®æˆ˜ï¼ˆå‡½æ•°çº§ç¼“å­˜ï¼‰**
æ“ä½œè·¯å¾„ï¼š

â‘  å°†ç›®æ ‡å‡½æ•°ï¼ˆå¦‚ fetchã€DB æŸ¥è¯¢ï¼‰ç”¨ unstable_cache åŒ…è£¹

â‘¡ è®¾ç½®è‡ªå®šä¹‰ç¼“å­˜ key å’Œå¤±æ•ˆæ—¶é—´

```plain
import { unstable_cache } from 'next/cache';

const getProducts = unstable_cache(
  async () => {
    const res = await fetch('https://api.example.com/products');
    return res.json();
  },
  ['products'], // ç¼“å­˜ key
  { revalidate: 10 } // ç§’çº§ç¼“å­˜
);

export default async function Page() {
  const products = await getProducts();
  return <ProductList data={products} />;
}
```

â—é¿å‘æç¤ºï¼š

| **é¿å‘ç‚¹** | **å»ºè®®** |
| --- | --- |
| unstable_cache ä¸èƒ½åŒ…è£¹ç»„ä»¶ | åªèƒ½åŒ…è£¹çº¯å‡½æ•° |
| key ç›¸åŒåˆ™å…±ç”¨ç¼“å­˜ | æ³¨æ„åŠ¨æ€å‚æ•°ä½œä¸º key |
| å’Œ revalidate é…åˆä½¿ç”¨æ—¶ï¼Œä»¥æ›´çŸ­å‘¨æœŸä¸ºä¸» | ä¼˜å…ˆè€ƒè™‘å‡½æ•°çº§ç¼“å­˜æå‡æ€§èƒ½ |


---

## **ğŸ”¬**** å®æˆ˜å¯¹æ¯”æ€»ç»“**
| **åœºæ™¯** | **æ¨èä½¿ç”¨** |
| --- | --- |
| ç¼“å­˜æ•´é¡µé™æ€å†…å®¹ï¼ˆå¦‚èµ„è®¯é¡µï¼‰ | revalidate |
| ç¼“å­˜æŸä¸ªæ•°æ®åº“æŸ¥è¯¢ç»“æœ | unstable_cache |
| å¤šé¡µé¢å¤ç”¨åŒä¸€ä¸ªæ•°æ® | unstable_cacheï¼ˆå¯è·¨ç»„ä»¶ï¼‰ |
| æ— éœ€ç¼“å­˜ï¼ˆå®æ—¶æ•°æ®ï¼‰ | SSR/ISRï¼Œä¸åŠ ç¼“å­˜é…ç½® |


---

## **ğŸ§ **** å»¶ä¼¸æ€è€ƒï¼šä»€ä¹ˆæ—¶å€™ä¸¤è€…ä¸€èµ·ç”¨ï¼Ÿ**
  


åœ¨ä»¥ä¸‹åœºæ™¯ä¸­ï¼Œå¯ç»„åˆä½¿ç”¨ï¼š

```plain
export const revalidate = 300; // æ•´é¡µç¼“å­˜ 5 åˆ†é’Ÿ

const getStock = unstable_cache(fetchStock, ['stock'], { revalidate: 60 }); // æ¯åˆ†é’Ÿåˆ·æ–°åº“å­˜

export default async function Page() {
  const stock = await getStock();
  return <div>å½“å‰åº“å­˜ï¼š{stock}</div>;
}
```

ğŸ¯æ•ˆæœï¼š

+ é¡µé¢æ¯ 5 åˆ†é’Ÿé‡æ–°æ„å»º
+ ä½†åº“å­˜æ•°æ®æ¯åˆ†é’Ÿæ›´æ–°ï¼Œé¿å…ç¼“å­˜é™ˆæ—§

---

## **âœ…**** æ€»ç»“ä¸€å¥è¯ï¼š**
  


<font style="color:#0e0e0e;">revalidate æ§é¡µé¢ç¼“å­˜æ—¶é—´ï¼Œunstable_cache æ§å‡½æ•°ç¼“å­˜æ—¶é—´ï¼Œ</font>**<font style="color:#0e0e0e;">ä¸¤è€…ç»„åˆä½¿ç”¨å¯å®ç°å¤šå±‚ç¼“å­˜ä¼˜åŒ–</font>**

